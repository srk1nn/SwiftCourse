# [Конспект] 4. Опциональный тип. Преобразование примитивных типов

## Опциональный тип в Swift

Опциональный тип в Swift используется для обозначения переменной, которая может содержать значение или быть nil (отсутствие значения). Чтобы объявить переменную как опциональную, необходимо добавить знак вопроса `?` после типа данных

```swift
var username: String? // username может содержать или строку, или nil
username = "Igor" // присваиваем переменной значение
username = nil // обнуляем значение
```

### Проверка наличия значения

Проверить наличие значения можно через операторы сравнения

```swift
// Отсутствует ли значение?
let usernameMissing = username == nil
// Есть ли значение?
let hasUsername = username != nil

```

### if let binding

Перед использованием опциональной переменной необходимо извлечь ее значение. Это можно сделать с помощью конструкции `if let`.

```swift
if let unwrappedUsername = username {
    print(unwrappedUsername)
}

// Иногда удобнее назвать новую переменную также, как и существующую
if let username = username { ... }

// В новых версиях Swift можно писать так. Это равноценно записи выше
if let username { ... }

```

### Принудительное разворачивание. Force unwrapping

Опциональную переменная можно принудительно развернуть с помощью `!`.

⚠️ Однако это может привести к ошибке, если значение отсутствует. По этой причине этот оператор часто запрещают использовать в проектах. Об этом же пишет и [Сбер в своей статье на хабре](https://habr.com/ru/companies/sberbank/articles/340736/) (см 2. Bang Operator! Как круто звучит, то что надо для опционала!)

```swift
let unwrappedUsername = username!
```

### Опциональная привязка. Nil-coalescing оператор

Опциональную переменные можно развернуть, задав ей значение по умолчанию. Это значение будет использоваться, если в опциональной переменной содержится nil.

```swift
let unwrappedUsername = username ?? "Значение по умолчанию"
```

## Преобразование типов

В Swift язык со статической типизацией и строгой проверкой типов. Поэтому он требует явного преобразования типов для предотвращения ошибок, связанных с неожиданными потерями данных или округлением.

Для преобразования примитивных типов достаточно написать тип, в который нужно преобразовать, а в круглых скобках указать переменную, которую нужно преобразовать.

**Преобразование примитивных типов в Int**

Для удобства справа написаны тип и значение, которые получаются на выходе

```swift
Int(23.5)     // Int: 23
Int("123")    // Int?: 123
Int("привет") // Int?: nil
Int(true)     // Int: 1
Int(false)    // Int: 2
```

Аналогично будет работать и преобразование в Float и Double.

**Преобразование примитивных типов в String**

```swift
String(23)             // String: "23"
String(123.5)          // String: "123.5" 
String(Character("a")) // String: "a"
String(true)           // String: "true"
String(false)          // String: "false"
```

**Преобразование примитивных типов в Bool**

```swift
Bool(0)      // Bool: false
Bool(1)      // Bool: true
Bool(123.5)  // Bool: true
Bool("true") // Bool?: true
Bool("1")    // Bool?: nil
```
